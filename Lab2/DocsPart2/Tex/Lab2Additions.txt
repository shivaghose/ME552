1e) When starting at the nominal position, the two models exhibit the same general behavior. However, changing the start point by greater than 0.01mm causes the nonlinear model to become unstable and fall away, while the linear model remains stable. Because the model is uncontrolled, we expect the system to be unstable. However, the linearized model does not include the squared current and distance terms, so it is more "optimistic" in terms of keeping the system stable. While the linearization does not agree with the nonlinear model over a large range, the general behavior is similar very close to our set point. Therefore, we believe our linearization assumptions are sufficient for the model, and the addition of a controller will improve the agreement between the models.

1g)

2b) Within the region where both models are stable, their overall behvior is similar, with both undergoing some oscilations before settling at distances (the steady-state values are within 0.1mm of each other. The main difference between the models is that the linear model has a longer settling time, regardless of whether the starting point is above or below the set point. Another major difference is that when the start point is moved closer to the electromagnet, the linear model becomes unstable first, but it's the nonlinear model that becomes unstable first when the start point is moved further from the electromagnet. 

2c) The controller above does match the controller we used in the lab exercise during the previous week. Initially we had designed a new controller for this exercise, with different pole and zero locations, and a different gain value. However, both the nonlinear and linearized simulink models were unstable under all of the conditions and variations we attempted. After discarding the new values and using the same poles, zeros, and gains that we had implemented in LabView on the test apparatus, the models became stable. This may be because prior to designing the controller for LabView, we conducted numerous tests to identify the parameters of the real system and modeled the various sub-systems. 

2d) The block diagram below illustrates how we ensure we have negative feedback in our system. If we start at the far right and assume that the ball just moved slightly above the set point (closer to the electromagnet), the sensor outputs a voltage related to this position which will always be positive. This voltage is then converted to position (m) and subtracted from the set point. Because the ball is above the set point, the error will be positive. The error signal then passes through a gain block of -1 to flip its sign to negative. The controller takes in the negative error and outputs a negative voltage. By adding this negative voltage to the bias voltage, a lower command voltage is sent to the driver than previously (the starting assumption was that the ball had been at the setpoint, but just moved up). This results in a smaller current being sent to the actuator, which results in less force from the electromagnet. Less force from the electromagnet results in the ball falling further away from the magnet, back towards the set point. This is the behavior that we want.

Figure A. Block Diagram of System: Signs Ensure Negative Feedback 

Similarly, if the ball is below the setpoint, the error will negative, and the inverting unity gain block will send a positive error into the controller, which will then output a positive voltage. Adding this voltage to the bias voltage results in a larger command voltage than when the ball is at the set point, so the current to the actuator will increase. The increased current will result in a larger force from the electromagnet, which will pull the ball back up towards the set point. Again, this is the behavior we want, so the signs within our system are correct. Because the physical and electronic sub-systems have restrictions on their signs (e.g. the sensor is tuned to always output between 0 and 10 volts), inserting the negation before the controller is the most important step to ensure we have stabilizing feedback.  